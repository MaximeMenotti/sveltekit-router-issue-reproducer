#  🧪 Sphere POC 
## 🤷 ️Purpose of this POC
To understand the purpose of this POC please read our [wiki](https://wiki.decathlon.net/pages/viewpage.action?spaceKey=CREATION&title=Sphere+-+Technical+Strategy)

## 🏛 Architecture 
This POC is composed by 2 folder one for content renderer and one consumer

### ⚙️ svelte-content-renderer 
An example of what our new content renderer could be. It can render static HTML content through API by url `/fragement`. You can access to all given component by using `/fragment?component=Header`

Kudos to @thollander for the inspiration and [demo](https://github.com/dktunited/break-legacy-with-svelte) of this concept

### ⚙️ next-js-consumer
An example of consumer build with [Next js](https://nextjs.org/)

Working with SSR (calling `/api/render` server side to get static HTML) and hydrate on client side by adding `sphere-content.js` script generated by content-renderer

### ⚙️ svelte-consumer
An example of consumer build with [Svelte](https://svelte.dev/)

Working without SSR.

## 👷 Build & Run

### 🐳 With docker
To run content renderer and all consumers please use following command:
```shell
docker-compose up
```

### ✋ Without docker
1. Run content-renderer
```shell
cd svelte-content-renderer
yarn install
yarn build
node ./server.js
```

2. Run next-js consumer
```shell
cd next-js-consumer
yarn install
yarn build
yarn start
```

3. Run svelte consumer
```shell
cd svelte-consumer
yarn install
yarn build
yarn start
```

## 🎉 Enjoy
All consumer are accessible locally on their affected ports:

| Consumer | Url                   |
| -------- | --------------------- |
| Next js  | http://localhost:3001 |
| Svelte   | http://localhost:3002 |

# Next step
- [ ] Study access restriction and authentication.
- [ ] Add varnish cache
- [X] Connect sphere api

